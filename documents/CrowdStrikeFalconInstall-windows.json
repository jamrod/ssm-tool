{
    "schemaVersion": "2.2",
    "description": "Install CrowdStrike Falcon Sensor Windows",
    "parameters": {
        "presignedurl": {
            "type": "String"
        },
        "cid": {
            "type": "String",
            "default": "50E47E6AF55B4A7C93688E7F6AA9E229-A8"
        }
    },
    "mainSteps": [
        {
            "action": "aws:runPowerShellScript",
            "name": "Get_and_Install",
            "inputs": {
                "runCommand": [
                    "cd\\",
                    "wget -outfile WindowsSensor.MaverickGyr.exe \"{{ presignedurl }}\"",
                    ".\\WindowsSensor.MaverickGyr.exe /install /quiet /norestart CID={{ cid }}",
                    "remove-item C:\\WindowsSensor.MaverickGyr.exe -force",
                    "if (-not(Test-Path C:\\'Program Files'\\CrowdStrike)) {",
                    "   exit 1",
                    "}"
                ]
            }
        }
    ]
}